# Test Automation Code Generator

A Python tool that automatically generates test code scaffolding from source files, supporting both pytest and unittest frameworks.

## Features

- **Automatic Test Generation**: Analyzes Python source files and generates test stubs for all functions and methods
- **Multiple Framework Support**: Generates tests for both pytest and unittest frameworks
- **Smart Parsing**: Uses AST (Abstract Syntax Tree) to extract function signatures, arguments, and docstrings
- **Template-Based**: Creates well-structured test templates following AAA (Arrange-Act-Assert) pattern
- **CLI Interface**: Easy-to-use command-line interface

## Installation

No additional dependencies required beyond Python 3.6+. The tool uses only standard library modules.

## Usage

### Basic Usage

Generate pytest tests (default):
```bash
python3 test_generator.py source_file.py
```

This creates `source_file_test.py` with pytest test stubs.

### Specify Output File

```bash
python3 test_generator.py source_file.py -o tests/test_source.py
```

### Use unittest Framework

```bash
python3 test_generator.py source_file.py -f unittest
```

### Command-Line Options

- `source_file`: Path to the Python source file (required)
- `-o, --output`: Output test file path (default: `<source_file>_test.py`)
- `-f, --framework`: Testing framework - `pytest` or `unittest` (default: `pytest`)

## Example

Given a source file `example_module.py`:

```python
def add(a: int, b: int) -> int:
    """Add two numbers together."""
    return a + b

def multiply(x: float, y: float) -> float:
    """Multiply two numbers."""
    return x * y
```

Run the generator:
```bash
python3 test_generator.py example_module.py
```

This generates `example_module_test.py`:

```python
"""
Automated tests for example_module.py

This file was auto-generated by TestCodeGenerator.
Please fill in the TODO sections with actual test implementations.
"""

import pytest
# TODO: Import the module to test
# import example_module


def test_add():
    """Test for add."""
    # TODO: Implement test for add
    # Function signature: add(a, b)
    # Description: Add two numbers together.
    
    # Arrange
    # TODO: Set up test data and expected values
    
    # Act
    # result = example_module.add(...)
    
    # Assert
    # assert result == expected_value
    pass

def test_multiply():
    """Test for multiply."""
    # TODO: Implement test for multiply
    # Function signature: multiply(x, y)
    # Description: Multiply two numbers.
    
    # Arrange
    # TODO: Set up test data and expected values
    
    # Act
    # result = example_module.multiply(...)
    
    # Assert
    # assert result == expected_value
    pass
```

## How It Works

1. **Parse Source File**: Uses Python's `ast` module to parse the source code
2. **Extract Functions**: Identifies all functions and methods (excluding private functions starting with `_`)
3. **Collect Metadata**: Extracts function names, arguments, docstrings, and return type annotations
4. **Generate Tests**: Creates test stubs using framework-specific templates
5. **Write Output**: Saves the generated test file

## Generated Test Structure

### Pytest Tests
- Function-based test structure
- Uses `assert` statements
- Follows AAA pattern (Arrange-Act-Assert)
- Includes TODO comments for implementation

### Unittest Tests
- Class-based test structure
- Inherits from `unittest.TestCase`
- Includes `setUp()` and `tearDown()` methods
- Uses `self.assertEqual()` and other assertion methods
- Includes `if __name__ == '__main__'` block for standalone execution

## Customization

The `TestCodeGenerator` class can be used programmatically:

```python
from test_generator import TestCodeGenerator

generator = TestCodeGenerator(framework='pytest')
functions = generator.parse_source_file('my_module.py')
generator.generate_test_file('my_module.py', 'test_my_module.py')
```

## Limitations

- Currently supports Python files only
- Generates basic test stubs - actual test logic must be implemented manually
- Does not analyze function complexity or generate test data automatically
- Private functions (starting with `_`) are skipped (except special methods like `__init__`)

## Future Enhancements

- Support for more testing frameworks (nose2, Robot Framework)
- Automatic test data generation based on type hints
- Integration with type checkers for better parameter analysis
- Support for async functions
- Mock generation for external dependencies
- Code coverage analysis integration

## License

This project is licensed under the MIT License - see the licence.md file for details.
